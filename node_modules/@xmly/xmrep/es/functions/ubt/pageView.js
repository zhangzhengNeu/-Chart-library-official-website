import { __assign } from "tslib";
import event from './event';
import { repTypes } from '../../config';
import pageData from '../../share/pageData';
import { notifyNative } from '../../share/iting';
import { set as setCache } from '../../share/cache';
import { UBT_PAGE_VIEW_CACHE_KEY } from './constants';
/** 页面曝光 */
export default function pageView(metaId, currPage, extra) {
    if (extra === void 0) { extra = {}; }
    var prevPage = pageData.prevPage, prevModule = pageData.prevModule;
    pageData.time = +new Date();
    pageData.prevPage = currPage;
    pageData.prevModule = undefined;
    setCache(UBT_PAGE_VIEW_CACHE_KEY, __assign({ currPage: currPage }, extra));
    notifyNative(currPage);
    return event.bind(this)(metaId, repTypes.UBT.subTypes.PAGE_VIEW, __assign({ prevPage: prevPage,
        currPage: currPage,
        prevModule: prevModule }, (!extra.pageShowNum ? __assign({ pageShowNum: 1 }, extra) : extra)));
}
